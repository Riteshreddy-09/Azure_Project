select * from [dbo].[source_cars_data]

select * from dbo.watermark_table

select max(Date_Id) from [dbo].[source_cars_data]

select * from dbo.watermark_table

create table watermark_table
(
    last_load Varchar(2000)
)

select * from watermark_table

select min(Date_ID) from [dbo].[source_cars_data]

Insert into watermark_table values('DT00000')

select * from [dbo].[source_cars_data] where DATE_ID > 'DT00000'

select count(*) from [dbo].[source_cars_data] where DATE_ID > 'DT00000'

select count(*) from [dbo].[source_cars_data] 

--STORED PROCEDURE

CREATE PROCEDURE UpdateWatermarkTable
    @lastload Varchar(200)
AS
BEGIN
     --Start the transaction
      BEGIN Transaction;

   --Update the incremental column in the table
   UPDATE watermark_table
   SET last_load = @lastload
   COMMIT Transaction;
   END;
